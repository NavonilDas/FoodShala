CREATE DATABASE foodshala CHARACTER SET utf8 COLLATE utf8_general_ci;

CREATE TABLE user_type(
	id INT PRIMARY KEY AUTO_INCREMENT,
	type VARCHAR(20) NOT NULL
);

INSERT INTO user_type(`type`) VALUES
('Resturant'),
('Customer');

CREATE TABLE preference(
	id INT PRIMARY KEY AUTO_INCREMENT,
	name VARCHAR(50) NOT NULL
);

INSERT INTO preference(`name`) VALUES
('Veg'),
('Non Veg');

CREATE TABLE user(
	id INT PRIMARY KEY AUTO_INCREMENT,
	name VARCHAR(20) NOT NULL,
	email VARCHAR(255) NOT NULL UNIQUE,
	phone INT(10) NOT NULL UNIQUE,
	password VARCHAR(1024) NOT NULL,
	address VARCHAR(255),
	created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
	preference int,
	type int NOT NULL,
	FOREIGN KEY (type) REFERENCES user_type(id),
	FOREIGN KEY (preference) REFERENCES preference(id),
	INDEX user_type(type)
);


CREATE TABLE food(
	id INT PRIMARY KEY AUTO_INCREMENT,
	name VARCHAR(20) NOT NULL,
	price FLOAT NOT NULL,
	thumbnail VARCHAR(255) NOT NULL,
	created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
	type int NOT NULL,
	created_by int NOT NULL,
	FOREIGN KEY (type) REFERENCES preference(id),
	FOREIGN KEY (created_by) REFERENCES user(id)
);


INSERT INTO food(`name`,`price`,`thumbnail`,`type`,`created_by`)
VALUES
('ABC1',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC2',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC3',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC4',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC5',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC6',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC7',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC8',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC9',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC10',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC11',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC12',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC13',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC14',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC15',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC16',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC17',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC18',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC19',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC20',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC21',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC22',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC23',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC24',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC25',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC26',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC27',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC28',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC29',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC30',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC31',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2),
('ABC32',100,'c0186c80f13371b9b238488bae14f5bd.JPG',1,2);

CREATE TABLE cart(
	food_id int NOT NULL,
	user_id int NOT NULL,
	quantity int NOT NULL DEFAULT 1,
	FOREIGN KEY (food_id) REFERENCES food(id),
	FOREIGN KEY (user_id) REFERENCES user(id),
	PRIMARY KEY(food_id,user_id)
);

CREATE TABLE food_order(
	id INT PRIMARY KEY AUTO_INCREMENT,
	`food_id` INT NOT NULL,
	`user_id` INT NOT NULL,
	`status` ENUM('Pending','Completed','Rejected') NOT NULL DEFAULT 'Pending',
	`quantity` int NOT NULL DEFAULT 1,
	created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
	FOREIGN KEY (food_id) REFERENCES food(id),
	FOREIGN KEY (user_id) REFERENCES user(id),
	INDEX(status)
);
